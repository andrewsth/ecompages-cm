<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: GoController</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">GoController</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../files/app/controllers/go_controller_rb.html">
                app/controllers/go_controller.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                <a href="ApplicationController.html">
                ApplicationController
               </a>
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
This controller contains methods for the front-end functions
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000165">about_us</a>&nbsp;&nbsp;
      <a href="#M000154">account</a>&nbsp;&nbsp;
      <a href="#M000173">add_to_cart</a>&nbsp;&nbsp;
      <a href="#M000172">ajax_add_to_cart</a>&nbsp;&nbsp;
      <a href="#M000160">category</a>&nbsp;&nbsp;
      <a href="#M000168">change_email_settings</a>&nbsp;&nbsp;
      <a href="#M000170">change_password</a>&nbsp;&nbsp;
      <a href="#M000164">contact_us</a>&nbsp;&nbsp;
      <a href="#M000175">decrease_quantity</a>&nbsp;&nbsp;
      <a href="#M000174">delete_from_cart</a>&nbsp;&nbsp;
      <a href="#M000178">freight</a>&nbsp;&nbsp;
      <a href="#M000150">index</a>&nbsp;&nbsp;
      <a href="#M000155">invoice</a>&nbsp;&nbsp;
      <a href="#M000177">large_image</a>&nbsp;&nbsp;
      <a href="#M000161">login</a>&nbsp;&nbsp;
      <a href="#M000162">logout</a>&nbsp;&nbsp;
      <a href="#M000158">order_has_been_placed</a>&nbsp;&nbsp;
      <a href="#M000151">page</a>&nbsp;&nbsp;
      <a href="#M000152">pages</a>&nbsp;&nbsp;
      <a href="#M000176">password_resend</a>&nbsp;&nbsp;
      <a href="#M000171">place_order</a>&nbsp;&nbsp;
      <a href="#M000159">product</a>&nbsp;&nbsp;
      <a href="#M000167">product_refunds_specifications</a>&nbsp;&nbsp;
      <a href="#M000163">registration</a>&nbsp;&nbsp;
      <a href="#M000157">search</a>&nbsp;&nbsp;
      <a href="#M000166">terms_conditions</a>&nbsp;&nbsp;
      <a href="#M000153">update_account_info</a>&nbsp;&nbsp;
      <a href="#M000156">view_cart</a>&nbsp;&nbsp;
      <a href="#M000169">view_image</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000165" class="method-detail">
        <a name="M000165"></a>

        <div class="method-heading">
          <a href="#M000165" class="method-signature">
          <span class="method-name">about_us</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000165-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000165-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 426</span>
426:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">about_us</span>
427:     <span class="ruby-comment cmt">#</span>
428:     <span class="ruby-ivar">@page_title</span> = <span class="ruby-value str">&quot;About Us&quot;</span>
429:     <span class="ruby-ivar">@page</span> = <span class="ruby-constant">Page</span>.<span class="ruby-identifier">find_by_title</span>(<span class="ruby-ivar">@page_title</span>)
430:     <span class="ruby-identifier">render</span>(<span class="ruby-identifier">:file</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{RAILS_ROOT}/app/views/templates/#{Shop.def_template_name}/frontend/#{action_name}.html.erb&quot;</span>, 
431:       <span class="ruby-identifier">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
432:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000154" class="method-detail">
        <a name="M000154"></a>

        <div class="method-heading">
          <a href="#M000154" class="method-signature">
          <span class="method-name">account</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000154-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000154-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 110</span>
110:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">account</span>
111:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:label</span>] = <span class="ruby-value str">&quot;my-acct&quot;</span>
112:     <span class="ruby-ivar">@page_title</span> = <span class="ruby-value str">&quot;My Account&quot;</span>
113:     <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">getAccount</span>()
114:     
115:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@account</span>.<span class="ruby-identifier">blank?</span>
116:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;Please login.&quot;</span>
117:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'login'</span>, <span class="ruby-identifier">:controller=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'go'</span>
118:     <span class="ruby-keyword kw">else</span>
119:       <span class="ruby-comment cmt"># An account holder</span>
120:       <span class="ruby-ivar">@orders</span> = <span class="ruby-ivar">@account</span>.<span class="ruby-identifier">orders</span>
121:       
122:       <span class="ruby-identifier">render</span>(<span class="ruby-identifier">:file</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{RAILS_ROOT}/app/views/templates/#{Shop.def_template_name}/frontend/#{action_name}.html.erb&quot;</span>, 
123:         <span class="ruby-identifier">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
124:     <span class="ruby-keyword kw">end</span>
125:     
126:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000173" class="method-detail">
        <a name="M000173"></a>

        <div class="method-heading">
          <a href="#M000173" class="method-signature">
          <span class="method-name">add_to_cart</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000173-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000173-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 656</span>
656:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_to_cart</span>
657:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span>
658:       <span class="ruby-identifier">product</span> = <span class="ruby-constant">Product</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:pid</span>])
659:       
660:       <span class="ruby-identifier">ui</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:ui</span>]
661:       
662:       <span class="ruby-identifier">account</span> = <span class="ruby-identifier">getAccount</span>()
663:             
664:       <span class="ruby-identifier">quantity</span> = <span class="ruby-value">0</span>
665:             
666:       <span class="ruby-identifier">quantity</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:cart</span>][<span class="ruby-identifier">:quantity</span>].<span class="ruby-identifier">to_i</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:cart</span>] <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:cart</span>][<span class="ruby-identifier">:quantity</span>]
667:       
668:       <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:cart</span>] = <span class="ruby-constant">SessionCart</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">account</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:cart</span>].<span class="ruby-identifier">nil?</span>
669:       <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:cart</span>].<span class="ruby-identifier">add_product</span>(<span class="ruby-identifier">product</span>.<span class="ruby-identifier">id</span>)
670:         
671:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">quantity</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">2</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">quantity</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">50</span>
672:         <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">i</span> <span class="ruby-keyword kw">in</span> <span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-identifier">quantity</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>
673:           <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:cart</span>].<span class="ruby-identifier">add_product</span>(<span class="ruby-identifier">product</span>.<span class="ruby-identifier">id</span>)
674:         <span class="ruby-keyword kw">end</span>  
675:       <span class="ruby-keyword kw">end</span>  
676:               
677:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;Product(s) has been added to shopping cart.&quot;</span>
678:       
679:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ui</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;1&quot;</span>
680:         <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'product'</span>,<span class="ruby-identifier">:controller=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'go'</span>, <span class="ruby-identifier">:id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">product</span>.<span class="ruby-identifier">id</span>)
681:       <span class="ruby-keyword kw">else</span>
682:         <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'view_cart'</span>,<span class="ruby-identifier">:controller=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'go'</span>, <span class="ruby-identifier">:id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">product</span>.<span class="ruby-identifier">id</span>)
683:       <span class="ruby-keyword kw">end</span>
684:       
685:       
686:       <span class="ruby-comment cmt">#      else</span>
687:       <span class="ruby-comment cmt">#        #</span>
688:       <span class="ruby-comment cmt">#        flash[:notice] = &quot;We are sorry, please login first.&quot;</span>
689:       <span class="ruby-comment cmt">#       </span>
690:       <span class="ruby-comment cmt">#        session[:should_remember_product_id] = true</span>
691:       <span class="ruby-comment cmt">#       </span>
692:       <span class="ruby-comment cmt">#        redirect_to(:action =&gt; &quot;login&quot;, :controller =&gt;&quot;go&quot;)</span>
693:       <span class="ruby-comment cmt">#      end    </span>
694:     <span class="ruby-keyword kw">end</span>
695:           
696:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">get?</span>
697:       <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;index&quot;</span>, <span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;go&quot;</span>)
698:     <span class="ruby-keyword kw">end</span>
699:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000172" class="method-detail">
        <a name="M000172"></a>

        <div class="method-heading">
          <a href="#M000172" class="method-signature">
          <span class="method-name">ajax_add_to_cart</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000172-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000172-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 651</span>
651:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ajax_add_to_cart</span>
652:     <span class="ruby-comment cmt">#</span>
653:     
654:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000160" class="method-detail">
        <a name="M000160"></a>

        <div class="method-heading">
          <a href="#M000160" class="method-signature">
          <span class="method-name">category</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000160-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000160-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 284</span>
284:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">category</span>
285:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>].<span class="ruby-identifier">to_i</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
286:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'index'</span>
287:     <span class="ruby-keyword kw">else</span>
288:   
289:       <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:label</span>] = <span class="ruby-value str">&quot;&quot;</span>
290:       <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">getAccount</span>()
291:     
292:       <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:sort</span>] = <span class="ruby-value str">&quot;id DESC&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:sort</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span>
293:       <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:sort</span>] = <span class="ruby-value str">'price'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:sort</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;lprice&quot;</span>
294:       <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:sort</span>] = <span class="ruby-value str">'id DESC'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:sort</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;latest&quot;</span>
295:       <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:sort</span>] = <span class="ruby-value str">'price DESC'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:sort</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;hprice&quot;</span>
296:       <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:sort</span>] = <span class="ruby-value str">'title'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:sort</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;title&quot;</span>
297:     
298:       <span class="ruby-ivar">@category</span> = <span class="ruby-constant">Category</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
299:       <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:category_id</span>] = <span class="ruby-ivar">@category</span>.<span class="ruby-identifier">id</span>
300:      
301:     
302:       <span class="ruby-ivar">@page_title</span> = <span class="ruby-ivar">@category</span>.<span class="ruby-identifier">name</span>
303:     
304:       <span class="ruby-ivar">@products</span> = <span class="ruby-constant">Product</span>.<span class="ruby-identifier">paginate</span>(<span class="ruby-identifier">:order=</span><span class="ruby-operator">&gt;</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:sort</span>], 
305:         <span class="ruby-identifier">:per_page</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">10</span>,
306:         <span class="ruby-identifier">:conditions=</span><span class="ruby-operator">&gt;</span>[<span class="ruby-value str">&quot;category_id = ? or category_id_fix_1 = ? or category_id_fix_2 = ?&quot;</span>, <span class="ruby-ivar">@category</span>.<span class="ruby-identifier">id</span>, <span class="ruby-ivar">@category</span>.<span class="ruby-identifier">id</span>, <span class="ruby-ivar">@category</span>.<span class="ruby-identifier">id</span>],
307:         <span class="ruby-identifier">:page=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:page</span>])
308:                               
309:       <span class="ruby-identifier">render</span>(<span class="ruby-identifier">:file</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{RAILS_ROOT}/app/views/templates/#{Shop.def_template_name}/frontend/#{action_name}.html.erb&quot;</span>, 
310:         <span class="ruby-identifier">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
311:     <span class="ruby-keyword kw">end</span>        
312:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000168" class="method-detail">
        <a name="M000168"></a>

        <div class="method-heading">
          <a href="#M000168" class="method-signature">
          <span class="method-name">change_email_settings</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
No Render actions ####
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000168-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000168-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 463</span>
463:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">change_email_settings</span>
464:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span>
465:       <span class="ruby-identifier">account</span> = <span class="ruby-identifier">getAccount</span>()
466:       <span class="ruby-identifier">value</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:account</span>][<span class="ruby-identifier">:special_offers</span>].<span class="ruby-identifier">to_i</span>
467:       <span class="ruby-identifier">account</span>.<span class="ruby-identifier">update_attribute</span>(<span class="ruby-value str">&quot;special_offers&quot;</span>, <span class="ruby-identifier">value</span>)
468:       
469:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;Changes Saved.&quot;</span>
470:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'account'</span>, <span class="ruby-identifier">:controller=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'go'</span>
471:     <span class="ruby-keyword kw">else</span>
472:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'account'</span>, <span class="ruby-identifier">:controller=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'go'</span>
473:     <span class="ruby-keyword kw">end</span>    
474:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000170" class="method-detail">
        <a name="M000170"></a>

        <div class="method-heading">
          <a href="#M000170" class="method-signature">
          <span class="method-name">change_password</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Allowing <a href="GoController.html#M000154">account</a> holder changing
password
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000170-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000170-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 490</span>
490:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">change_password</span>
491:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span>
492:       <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">getAccount</span>()
493:       <span class="ruby-identifier">pass</span> = <span class="ruby-keyword kw">true</span>
494:       <span class="ruby-identifier">err</span> = <span class="ruby-value str">&quot;&quot;</span>
495:       <span class="ruby-identifier">old</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:password</span>][<span class="ruby-identifier">:old</span>]
496:       <span class="ruby-identifier">new1</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:password</span>][<span class="ruby-identifier">:new1</span>]
497:       <span class="ruby-identifier">new2</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:password</span>][<span class="ruby-identifier">:new2</span>]
498:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">new1</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">6</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">new1</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">18</span>
499:         <span class="ruby-identifier">pass</span> = <span class="ruby-keyword kw">false</span>
500:         <span class="ruby-identifier">err</span> = <span class="ruby-value str">&quot;Length of password should be between 6 and 18.&quot;</span>
501:       <span class="ruby-keyword kw">end</span>
502:        
503:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">new1</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">new2</span>
504:         <span class="ruby-identifier">pass</span> = <span class="ruby-keyword kw">false</span>
505:         <span class="ruby-identifier">err</span> = <span class="ruby-value str">&quot;The retyped password doesn't match the new password.&quot;</span>
506:       <span class="ruby-keyword kw">end</span>
507:       
508:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">old</span> <span class="ruby-operator">!=</span> <span class="ruby-ivar">@account</span>.<span class="ruby-identifier">password</span>
509:         <span class="ruby-identifier">pass</span> = <span class="ruby-keyword kw">false</span>
510:         <span class="ruby-identifier">err</span> = <span class="ruby-value str">&quot;The password you entered doesn't match the password in our system.&quot;</span>
511:       <span class="ruby-keyword kw">end</span>
512:       
513:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">pass</span>
514:         <span class="ruby-ivar">@account</span>.<span class="ruby-identifier">update_attribute</span>(<span class="ruby-value str">&quot;password&quot;</span>, <span class="ruby-identifier">new1</span>)
515:         <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;Password updated.&quot;</span>
516:         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'account'</span>, <span class="ruby-identifier">:controller=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'go'</span>
517:       <span class="ruby-keyword kw">else</span>
518:         <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-identifier">err</span>
519:         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'account'</span>, <span class="ruby-identifier">:controller=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'go'</span>
520:       <span class="ruby-keyword kw">end</span>    
521:       
522:     <span class="ruby-keyword kw">else</span>
523:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;Please login.&quot;</span>
524:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'login'</span>, <span class="ruby-identifier">:controller=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'go'</span>
525:     <span class="ruby-keyword kw">end</span>
526:     
527:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">get?</span>
528:       <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;index&quot;</span>, <span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;go&quot;</span>)
529:     <span class="ruby-keyword kw">end</span>    
530:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000164" class="method-detail">
        <a name="M000164"></a>

        <div class="method-heading">
          <a href="#M000164" class="method-signature">
          <span class="method-name">contact_us</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Methods for Default Pages ##
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000164-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000164-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 387</span>
387:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">contact_us</span>
388:     <span class="ruby-comment cmt">#</span>
389:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">get?</span>
390:       <span class="ruby-ivar">@page_title</span> = <span class="ruby-value str">&quot;Contact Us&quot;</span>
391:       <span class="ruby-ivar">@page</span> = <span class="ruby-constant">Page</span>.<span class="ruby-identifier">find_by_title</span>(<span class="ruby-ivar">@page_title</span>)
392:     <span class="ruby-keyword kw">end</span>
393:           
394:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span>
395:       <span class="ruby-comment cmt"># TODO</span>
396:       <span class="ruby-identifier">pass</span> = <span class="ruby-keyword kw">true</span>
397:       <span class="ruby-identifier">error</span> = <span class="ruby-value str">&quot;Please check the name, email and note fields are not empty.&quot;</span>
398:             
399:       <span class="ruby-identifier">name</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:contact</span>][<span class="ruby-identifier">:name</span>] 
400:       <span class="ruby-identifier">email</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:contact</span>][<span class="ruby-identifier">:email</span>]
401:       <span class="ruby-identifier">phone</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:contact</span>][<span class="ruby-identifier">:phone</span>]
402:       <span class="ruby-identifier">note</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:contact</span>][<span class="ruby-identifier">:note</span>]
403:             
404:       <span class="ruby-identifier">pass</span> = <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">blank?</span>
405:       <span class="ruby-identifier">pass</span> = <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">email</span>.<span class="ruby-identifier">blank?</span>
406:       <span class="ruby-identifier">pass</span> = <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">note</span>.<span class="ruby-identifier">blank?</span>
407:             
408:             
409:       <span class="ruby-comment cmt">#email = OrderMailer.create_sent(params[:contact][:name],params[:contact][:email],params[:contact][:phone],params[:contact][:note])</span>
410:       <span class="ruby-comment cmt">#email.set_content_type(&quot;text/html&quot;)</span>
411:       
412:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">pass</span>
413:         <span class="ruby-constant">OrderMailer</span>.<span class="ruby-identifier">deliver_formmessage</span>(<span class="ruby-identifier">name</span>,<span class="ruby-identifier">email</span>,<span class="ruby-identifier">phone</span>,<span class="ruby-identifier">note</span>)
414:         <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;Thank you! Your message has been sent, we will contact you shortly.&quot;</span>
415:         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'contact_us'</span>, <span class="ruby-identifier">:controller=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'go'</span>
416:       <span class="ruby-keyword kw">else</span>
417:         <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-identifier">error</span>
418:         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'contact_us'</span>, <span class="ruby-identifier">:controller=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'go'</span>
419:       <span class="ruby-keyword kw">end</span>  
420:     <span class="ruby-keyword kw">end</span>  
421:     <span class="ruby-identifier">render</span>(<span class="ruby-identifier">:file</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{RAILS_ROOT}/app/views/templates/#{Shop.def_template_name}/frontend/#{action_name}.html.erb&quot;</span>, 
422:       <span class="ruby-identifier">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
423:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000175" class="method-detail">
        <a name="M000175"></a>

        <div class="method-heading">
          <a href="#M000175" class="method-signature">
          <span class="method-name">decrease_quantity</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000175-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000175-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 719</span>
719:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">decrease_quantity</span>
720:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span>
721:       <span class="ruby-identifier">product</span> = <span class="ruby-constant">Product</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:pid</span>])
722:       <span class="ruby-comment cmt">#account = getAccount()</span>
723:             
724:       <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:cart</span>].<span class="ruby-identifier">decrease_quantity</span> <span class="ruby-identifier">product</span>
725:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;One product has been removed from cart.&quot;</span>
726:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'view_cart'</span>, <span class="ruby-identifier">:controller=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'go'</span>, <span class="ruby-identifier">:id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">product</span>.<span class="ruby-identifier">id</span>
727:       
728:     <span class="ruby-keyword kw">end</span>
729:           
730:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">get?</span>
731:       <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;index&quot;</span>, <span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;go&quot;</span>)
732:     <span class="ruby-keyword kw">end</span>
733:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000174" class="method-detail">
        <a name="M000174"></a>

        <div class="method-heading">
          <a href="#M000174" class="method-signature">
          <span class="method-name">delete_from_cart</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000174-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000174-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 701</span>
701:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">delete_from_cart</span>
702:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span>
703:       
704:       <span class="ruby-identifier">product</span> = <span class="ruby-constant">Product</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:pid</span>])
705:       <span class="ruby-comment cmt">#account = getAccount()</span>
706:             
707:       <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:cart</span>].<span class="ruby-identifier">delete_product</span>(<span class="ruby-identifier">product</span>.<span class="ruby-identifier">id</span>)
708:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;Product has been removed from cart.&quot;</span>      
709:       
710:       <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;view_cart&quot;</span>, <span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;go&quot;</span>, <span class="ruby-identifier">:id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">product</span>.<span class="ruby-identifier">id</span>)
711:       
712:     <span class="ruby-keyword kw">end</span>
713:           
714:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">get?</span>
715:       <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;index&quot;</span>, <span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;go&quot;</span>)
716:     <span class="ruby-keyword kw">end</span>  
717:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000178" class="method-detail">
        <a name="M000178"></a>

        <div class="method-heading">
          <a href="#M000178" class="method-signature">
          <span class="method-name">freight</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000178-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000178-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 776</span>
776:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">freight</span>
777:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:label</span>] = <span class="ruby-value str">&quot;&quot;</span>
778:     <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">getAccount</span>()
779:     <span class="ruby-ivar">@cart</span> = <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:cart</span>]
780:     
781:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:island</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;1&quot;</span>
782:       <span class="ruby-ivar">@island</span> = <span class="ruby-value str">&quot;North&quot;</span>
783:     <span class="ruby-keyword kw">else</span>
784:       <span class="ruby-ivar">@island</span> = <span class="ruby-value str">&quot;South&quot;</span>
785:     <span class="ruby-keyword kw">end</span>
786:     
787:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:rural</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;true&quot;</span>
788:       <span class="ruby-ivar">@rural</span> = <span class="ruby-value str">&quot;Yes&quot;</span>
789:     <span class="ruby-keyword kw">else</span>
790:       <span class="ruby-ivar">@rural</span> = <span class="ruby-value str">&quot;No&quot;</span>
791:     <span class="ruby-keyword kw">end</span>   
792:     <span class="ruby-identifier">render</span> <span class="ruby-identifier">:partial=</span><span class="ruby-operator">&gt;</span><span class="ruby-node">&quot;templates/#{Shop.def_template_name}/frontend/freight&quot;</span>
793:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000150" class="method-detail">
        <a name="M000150"></a>

        <div class="method-heading">
          <a href="#M000150" class="method-signature">
          <span class="method-name">index</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Render actions ####
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000150-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000150-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 22</span>
22:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">index</span>
23:     
24:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:label</span>] = <span class="ruby-value str">&quot;index&quot;</span>
25:     
26:     <span class="ruby-ivar">@page_title</span> = <span class="ruby-value str">&quot;Home&quot;</span>
27:     <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">getAccount</span>()
28:     
29:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:sort</span>] = <span class="ruby-value str">&quot;id DESC&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:sort</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span>
30:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:sort</span>] = <span class="ruby-value str">'price'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:sort</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;lprice&quot;</span>
31:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:sort</span>] = <span class="ruby-value str">'id DESC'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:sort</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;latest&quot;</span>
32:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:sort</span>] = <span class="ruby-value str">'price DESC'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:sort</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;hprice&quot;</span>
33:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:sort</span>] = <span class="ruby-value str">'title'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:sort</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;title&quot;</span>
34:     
35:     <span class="ruby-ivar">@products</span> = <span class="ruby-constant">Product</span>.<span class="ruby-identifier">paginate</span>(<span class="ruby-identifier">:order=</span><span class="ruby-operator">&gt;</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:sort</span>], 
36:       <span class="ruby-identifier">:per_page</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">16</span>, 
37:       <span class="ruby-identifier">:page=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:page</span>],
38:       <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;id != ?&quot;</span>, <span class="ruby-value">0</span>])
39:     
40:     <span class="ruby-ivar">@current_page_number</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:page</span>]
41:     <span class="ruby-ivar">@current_page_number</span> = <span class="ruby-value">1</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@current_page_number</span>.<span class="ruby-identifier">blank?</span>
42:     
43:     <span class="ruby-identifier">render</span>(<span class="ruby-identifier">:file</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{RAILS_ROOT}/app/views/templates/#{Shop.def_template_name}/frontend/#{action_name}.html.erb&quot;</span>, 
44:       <span class="ruby-identifier">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
45:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000155" class="method-detail">
        <a name="M000155"></a>

        <div class="method-heading">
          <a href="#M000155" class="method-signature">
          <span class="method-name">invoice</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000155-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000155-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 129</span>
129:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">invoice</span>
130:     
131:     <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">getAccount</span>()
132:     
133:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@account</span>.<span class="ruby-identifier">blank?</span>
134:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;Please login.&quot;</span>
135:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'login'</span>, <span class="ruby-identifier">:controller=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'go'</span>
136:     <span class="ruby-keyword kw">else</span>
137:       <span class="ruby-comment cmt"># An account holder</span>
138:       <span class="ruby-ivar">@order</span> = <span class="ruby-constant">Order</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
139:       <span class="ruby-ivar">@page_title</span> = <span class="ruby-value str">&quot;View Invoice #: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>] 
140:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@order</span>.<span class="ruby-identifier">customer_id</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@account</span>.<span class="ruby-identifier">id</span>
141:         <span class="ruby-identifier">render</span>(<span class="ruby-identifier">:file</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{RAILS_ROOT}/app/views/templates/#{Shop.def_template_name}/frontend/#{action_name}.html.erb&quot;</span>, 
142:           <span class="ruby-identifier">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;invoice&quot;</span>)
143:       <span class="ruby-keyword kw">else</span>  
144:         <span class="ruby-identifier">render</span> <span class="ruby-identifier">:layout=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;invoice&quot;</span>, <span class="ruby-identifier">:inline=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;&lt;h2&gt;&lt;font color='red'&gt;Sorry, you are trying to view an invalid order.&lt;/font&gt;&lt;/h2&gt;&quot;</span>
145:       <span class="ruby-keyword kw">end</span>
146:     <span class="ruby-keyword kw">end</span>
147:     
148: <span class="ruby-comment cmt">#  rescue</span>
149: <span class="ruby-comment cmt">#    ## TODO: Error code explaination page</span>
150: <span class="ruby-comment cmt">#    redirect_to :action=&gt;'error_page'</span>
151:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000177" class="method-detail">
        <a name="M000177"></a>

        <div class="method-heading">
          <a href="#M000177" class="method-signature">
          <span class="method-name">large_image</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
BEGIN Frontstore AJAX Methods ##
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000177-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000177-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 768</span>
768:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">large_image</span>
769:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">get?</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span>
770:       <span class="ruby-ivar">@picture</span> = <span class="ruby-constant">Productimage</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:pid</span>])
771:       <span class="ruby-identifier">render</span> <span class="ruby-identifier">:partial=</span><span class="ruby-operator">&gt;</span><span class="ruby-node">&quot;templates/#{Shop.def_template_name}/frontend/large&quot;</span>
772:           
773:     <span class="ruby-keyword kw">end</span>  
774:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000161" class="method-detail">
        <a name="M000161"></a>

        <div class="method-heading">
          <a href="#M000161" class="method-signature">
          <span class="method-name">login</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000161-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000161-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 315</span>
315:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">login</span>
316:     <span class="ruby-ivar">@page_title</span> = <span class="ruby-value str">&quot;User Login&quot;</span>
317:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">get?</span>
318:       <span class="ruby-ivar">@page_title</span> = <span class="ruby-value str">&quot;Login&quot;</span>
319:                   
320:       <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:account_id</span>] = <span class="ruby-keyword kw">nil</span>
321:       <span class="ruby-comment cmt"># session[:cart] = nil</span>
322:       <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:account_type</span>] = <span class="ruby-keyword kw">nil</span>
323:       <span class="ruby-ivar">@account</span> = <span class="ruby-keyword kw">nil</span>
324:                         
325:       <span class="ruby-identifier">render</span>(<span class="ruby-identifier">:file</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{RAILS_ROOT}/app/views/templates/#{Shop.def_template_name}/frontend/#{action_name}.html.erb&quot;</span>, 
326:         <span class="ruby-identifier">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
327:       
328:     <span class="ruby-keyword kw">else</span>
329:       <span class="ruby-ivar">@account</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:account</span>])
330:       <span class="ruby-identifier">logged_in_account</span> = <span class="ruby-ivar">@account</span>.<span class="ruby-identifier">try_to_login</span>
331:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">logged_in_account</span>
332:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">logged_in_account</span>.<span class="ruby-identifier">suspended</span> <span class="ruby-operator">!=</span> <span class="ruby-value">1</span>
333:           <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:account_id</span>] = <span class="ruby-identifier">logged_in_account</span>.<span class="ruby-identifier">id</span>
334:                             
335:           <span class="ruby-comment cmt"># TODO: BUG: if an account's price level has been changed while</span>
336:           <span class="ruby-comment cmt">#   the account is in session. The sub_total of Class Cart will be</span>
337:           <span class="ruby-comment cmt">#   incorrect.</span>
338:           <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:cart</span>] = <span class="ruby-constant">SessionCart</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">logged_in_account</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:cart</span>].<span class="ruby-identifier">nil?</span>
339:                             
340:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:should_remember_product_id</span>]
341:             <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;product&quot;</span>, <span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;go&quot;</span>, <span class="ruby-identifier">:id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">:last_product_id_viewed</span>])
342:           <span class="ruby-keyword kw">else</span>
343:             <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;index&quot;</span>, <span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;go&quot;</span>)
344:           <span class="ruby-keyword kw">end</span>
345:                             
346:         <span class="ruby-keyword kw">else</span>
347:           <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;Your account is not actived.&quot;</span>
348:           <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;login&quot;</span>, <span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;go&quot;</span>)
349:         <span class="ruby-keyword kw">end</span>  
350:       <span class="ruby-keyword kw">else</span>
351:         <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;Invalid user/password combination.&quot;</span>
352:         <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;login&quot;</span>, <span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;go&quot;</span>)
353:       <span class="ruby-keyword kw">end</span>
354:     <span class="ruby-keyword kw">end</span>
355:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000162" class="method-detail">
        <a name="M000162"></a>

        <div class="method-heading">
          <a href="#M000162" class="method-signature">
          <span class="method-name">logout</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This actually is a &#8216;No Render action&#8216;
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000162-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000162-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 358</span>
358:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">logout</span>
359:     <span class="ruby-ivar">@page_title</span> = <span class="ruby-value str">&quot;Logged Out&quot;</span>
360:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:account_id</span>] = <span class="ruby-keyword kw">nil</span>
361:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:should_remember_product_id</span>] = <span class="ruby-keyword kw">false</span>
362:           
363:     <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;Logged out.&quot;</span>
364:     <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'login'</span>, <span class="ruby-identifier">:controller=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'go'</span>
365:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000158" class="method-detail">
        <a name="M000158"></a>

        <div class="method-heading">
          <a href="#M000158" class="method-signature">
          <span class="method-name">order_has_been_placed</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000158-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000158-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 245</span>
245:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">order_has_been_placed</span>
246:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:label</span>] = <span class="ruby-value str">&quot;&quot;</span>
247:     <span class="ruby-ivar">@page_title</span> = <span class="ruby-value str">&quot;Thank You!&quot;</span>
248:     <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">getAccount</span>()
249:     <span class="ruby-comment cmt">#</span>
250:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:cart</span>].<span class="ruby-identifier">clear</span>
251:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:freight_cost</span>] = <span class="ruby-value">0</span><span class="ruby-value">.0</span>
252:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:freight_suggests</span>] = <span class="ruby-value str">&quot;None.&quot;</span>
253:     
254:     <span class="ruby-identifier">render</span>(<span class="ruby-identifier">:file</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{RAILS_ROOT}/app/views/templates/#{Shop.def_template_name}/frontend/#{action_name}.html.erb&quot;</span>, 
255:       <span class="ruby-identifier">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
256:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000151" class="method-detail">
        <a name="M000151"></a>

        <div class="method-heading">
          <a href="#M000151" class="method-signature">
          <span class="method-name">page</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000151-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000151-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 47</span>
47:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">page</span>
48:     <span class="ruby-ivar">@page</span> = <span class="ruby-constant">Page</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
49:     <span class="ruby-ivar">@page_title</span> = <span class="ruby-ivar">@page</span>.<span class="ruby-identifier">title</span>
50:     <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">getAccount</span>()
51:     <span class="ruby-identifier">render</span>(<span class="ruby-identifier">:file</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{RAILS_ROOT}/app/views/templates/#{Shop.def_template_name}/frontend/#{action_name}.html.erb&quot;</span>, 
52:       <span class="ruby-identifier">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
53:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000152" class="method-detail">
        <a name="M000152"></a>

        <div class="method-heading">
          <a href="#M000152" class="method-signature">
          <span class="method-name">pages</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000152-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000152-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 55</span>
55:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">pages</span>
56:     <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">getAccount</span>()
57:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:label</span>] = <span class="ruby-value str">&quot;blog&quot;</span>
58:     
59:     <span class="ruby-ivar">@pages</span> = <span class="ruby-constant">Page</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:conditions=</span><span class="ruby-operator">&gt;</span>[<span class="ruby-value str">&quot;id &gt; 4&quot;</span>], <span class="ruby-identifier">:order=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;id DESC&quot;</span>)
60:     <span class="ruby-identifier">render</span>(<span class="ruby-identifier">:file</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{RAILS_ROOT}/app/views/templates/#{Shop.def_template_name}/frontend/#{action_name}.html.erb&quot;</span>, 
61:       <span class="ruby-identifier">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
62:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000176" class="method-detail">
        <a name="M000176"></a>

        <div class="method-heading">
          <a href="#M000176" class="method-signature">
          <span class="method-name">password_resend</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000176-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000176-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 735</span>
735:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">password_resend</span>
736:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">get?</span>
737:       <span class="ruby-comment cmt">#</span>
738:       <span class="ruby-identifier">render</span>(<span class="ruby-identifier">:file</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{RAILS_ROOT}/app/views/templates/#{Shop.def_template_name}/frontend/#{action_name}.html.erb&quot;</span>, 
739:         <span class="ruby-identifier">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
740:     <span class="ruby-keyword kw">end</span>
741:           
742:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span>
743:       <span class="ruby-identifier">email</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:password</span>][<span class="ruby-identifier">:email</span>]
744:       <span class="ruby-identifier">account</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">find_by_email</span>(<span class="ruby-identifier">email</span>)
745:             
746:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">account</span>
747:         <span class="ruby-comment cmt"># send email</span>
748:         <span class="ruby-constant">OrderMailer</span>.<span class="ruby-identifier">deliver_accountnew</span>(<span class="ruby-identifier">account</span>)
749:         <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;Your account information has been sent: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">account</span>.<span class="ruby-identifier">email</span>
750:         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'password_resend'</span>, <span class="ruby-identifier">:controller=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'go'</span>
751:       <span class="ruby-keyword kw">else</span>
752:         <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;Invalid Email address&quot;</span>
753:         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'password_resend'</span>, <span class="ruby-identifier">:controller=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'go'</span>
754:       <span class="ruby-keyword kw">end</span>    
755:     <span class="ruby-keyword kw">end</span>  
756:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000171" class="method-detail">
        <a name="M000171"></a>

        <div class="method-heading">
          <a href="#M000171" class="method-signature">
          <span class="method-name">place_order</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000171-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000171-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 532</span>
532:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">place_order</span>
533:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:label</span>] = <span class="ruby-value str">&quot;&quot;</span>
534:     <span class="ruby-ivar">@page_title</span> = <span class="ruby-value str">&quot;Place your Order&quot;</span>
535:     
536:     <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">getAccount</span>()
537:     <span class="ruby-ivar">@cart</span> = <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:cart</span>]
538:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:freight_suggests</span>] = <span class="ruby-value str">&quot;&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:freight_suggests</span>].<span class="ruby-identifier">blank?</span>
539:     
540:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">get?</span>
541:       <span class="ruby-ivar">@passed</span> = <span class="ruby-keyword kw">false</span>
542:       <span class="ruby-ivar">@passed</span> = <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:securitylevel</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;1&quot;</span>
543:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@account</span>.<span class="ruby-identifier">blank?</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@passed</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">false</span>
544:         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'login'</span>,<span class="ruby-identifier">:controller=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'go'</span> 
545:       <span class="ruby-keyword kw">else</span>
546:         <span class="ruby-identifier">render</span>(<span class="ruby-identifier">:file</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{RAILS_ROOT}/app/views/templates/#{Shop.def_template_name}/frontend/#{action_name}.html.erb&quot;</span>, 
547:           <span class="ruby-identifier">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
548:       <span class="ruby-keyword kw">end</span>  
549:     <span class="ruby-keyword kw">end</span>
550:     
551:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span>
552:       <span class="ruby-comment cmt"># check order</span>
553:       
554:       <span class="ruby-identifier">content_pass</span> = <span class="ruby-keyword kw">true</span>
555:       <span class="ruby-identifier">content_pass</span> = <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@account</span>.<span class="ruby-identifier">blank?</span>
556:       <span class="ruby-identifier">content_pass</span> = <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@account</span>.<span class="ruby-identifier">id</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:account_id</span>]
557:       <span class="ruby-identifier">content_pass</span> = <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@cart</span>.<span class="ruby-identifier">blank?</span>
558:       <span class="ruby-identifier">content_pass</span> = <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@cart</span>.<span class="ruby-identifier">items</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">0</span>
559:       <span class="ruby-identifier">content_pass</span> = <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:freight_cost</span>].<span class="ruby-identifier">blank?</span>
560:       <span class="ruby-identifier">content_pass</span> = <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:order</span>][<span class="ruby-identifier">:shipping_address</span>].<span class="ruby-identifier">blank?</span>
561:       <span class="ruby-comment cmt">#content_pass = false if params[:order][:postcode].blank?</span>
562:       
563:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">content_pass</span>
564:         <span class="ruby-comment cmt"># save order</span>
565:         
566:         <span class="ruby-identifier">all_saved_without_error</span> = <span class="ruby-keyword kw">true</span>
567:         
568:         <span class="ruby-identifier">order</span> = <span class="ruby-constant">Order</span>.<span class="ruby-identifier">new</span>
569:         <span class="ruby-identifier">order</span>.<span class="ruby-identifier">time_created</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
570:         <span class="ruby-identifier">order</span>.<span class="ruby-identifier">customer_id</span> = <span class="ruby-ivar">@account</span>.<span class="ruby-identifier">id</span>
571:        
572:         <span class="ruby-identifier">order</span>.<span class="ruby-identifier">shipping_address</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:order</span>][<span class="ruby-identifier">:shipping_address</span>]
573:         <span class="ruby-identifier">order</span>.<span class="ruby-identifier">postcode</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:order</span>][<span class="ruby-identifier">:postcode</span>]
574:         <span class="ruby-identifier">order</span>.<span class="ruby-identifier">donee</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:order</span>][<span class="ruby-identifier">:donee</span>]
575:         <span class="ruby-identifier">order</span>.<span class="ruby-identifier">suggested_freight_cost</span> = <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:freight_cost</span>].<span class="ruby-identifier">to_f</span>
576:         <span class="ruby-identifier">order</span>.<span class="ruby-identifier">suggested_freight_options</span> = <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:freight_suggests</span>]
577:         <span class="ruby-identifier">order</span>.<span class="ruby-identifier">last_time_of_sentmail</span> = <span class="ruby-keyword kw">nil</span>
578:         <span class="ruby-identifier">order</span>.<span class="ruby-identifier">note</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:order</span>][<span class="ruby-identifier">:note</span>]
579:         <span class="ruby-identifier">order</span>.<span class="ruby-identifier">note</span> = <span class="ruby-value str">&quot;No additional notes.&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:order</span>][<span class="ruby-identifier">:note</span>].<span class="ruby-identifier">blank?</span>
580:         <span class="ruby-identifier">order</span>.<span class="ruby-identifier">status</span> = <span class="ruby-value str">&quot;New&quot;</span>
581:         
582:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">order</span>.<span class="ruby-identifier">save</span>
583:           
584:           <span class="ruby-identifier">saved_items</span> = []
585:           
586:           <span class="ruby-comment cmt"># create order items</span>
587:           <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">item</span> <span class="ruby-keyword kw">in</span> <span class="ruby-ivar">@cart</span>.<span class="ruby-identifier">items</span>
588:             <span class="ruby-identifier">product</span> = <span class="ruby-constant">Product</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">item</span>.<span class="ruby-identifier">product_id</span>)
589:             <span class="ruby-identifier">orderitem</span> = <span class="ruby-constant">Orderitem</span>.<span class="ruby-identifier">new</span>
590:             <span class="ruby-identifier">orderitem</span>.<span class="ruby-identifier">order_id</span> = <span class="ruby-identifier">order</span>.<span class="ruby-identifier">id</span>
591:             <span class="ruby-identifier">orderitem</span>.<span class="ruby-identifier">product_id</span> = <span class="ruby-identifier">item</span>.<span class="ruby-identifier">product_id</span>
592:             
593:             <span class="ruby-identifier">price_in_order</span> = <span class="ruby-identifier">product</span>.<span class="ruby-identifier">price_for_account</span>(<span class="ruby-ivar">@account</span>)
594:             <span class="ruby-comment cmt">#price_in_order = price_in_order * (1 - @discount_percentage.to_f/100)</span>
595:             
596:             <span class="ruby-identifier">orderitem</span>.<span class="ruby-identifier">price_in_order</span> = <span class="ruby-identifier">price_in_order</span>
597:             <span class="ruby-identifier">orderitem</span>.<span class="ruby-identifier">quantity</span> = <span class="ruby-identifier">item</span>.<span class="ruby-identifier">quantity</span>
598:             
599:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">orderitem</span>.<span class="ruby-identifier">save</span>
600:               <span class="ruby-comment cmt"># saved</span>
601:               <span class="ruby-identifier">saved_items</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">orderitem</span>.<span class="ruby-identifier">id</span>
602:             <span class="ruby-keyword kw">else</span>  
603:               <span class="ruby-identifier">all_saved_without_error</span> = <span class="ruby-keyword kw">false</span>
604:             <span class="ruby-keyword kw">end</span>
605:           <span class="ruby-keyword kw">end</span>
606:           
607:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">all_saved_without_error</span>
608:             <span class="ruby-comment cmt"># all saved</span>
609: 
610:           <span class="ruby-keyword kw">else</span>
611:             <span class="ruby-comment cmt"># remove saved orderitems and the saved order</span>
612:             <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">item_id</span> <span class="ruby-keyword kw">in</span> <span class="ruby-identifier">saved_items</span>
613:               <span class="ruby-identifier">saved_item</span> = <span class="ruby-constant">Orderitem</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">item_id</span>)
614:               <span class="ruby-identifier">saved_item</span>.<span class="ruby-identifier">destory</span>
615:             <span class="ruby-keyword kw">end</span>  
616:           <span class="ruby-keyword kw">end</span>
617:           
618:         <span class="ruby-keyword kw">else</span>
619:           <span class="ruby-identifier">all_saved_without_error</span> = <span class="ruby-keyword kw">false</span>
620:         <span class="ruby-keyword kw">end</span>   
621:         
622:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">all_saved_without_error</span>
623:           <span class="ruby-comment cmt"># send email to admin</span>
624:           <span class="ruby-constant">OrderMailer</span>.<span class="ruby-identifier">deliver_ordernotice</span>(<span class="ruby-identifier">order</span>)
625:           <span class="ruby-comment cmt"># send email to customer</span>
626:           <span class="ruby-comment cmt">#email = OrderMailer.create_confirm(order)</span>
627:           <span class="ruby-comment cmt">#email.set_content_type(&quot;text/html&quot;)</span>
628:           <span class="ruby-constant">OrderMailer</span>.<span class="ruby-identifier">deliver_confirm</span>(<span class="ruby-identifier">order</span>)
629:           
630:           <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;Order has been placed!&quot;</span>
631:           <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'order_has_been_placed'</span>
632:         <span class="ruby-keyword kw">else</span>
633:           <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;Sorry, your order couldn't be placed. Please make sure you entered all information.&quot;</span>
634:           <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:back</span>
635:         <span class="ruby-keyword kw">end</span>    
636:         
637:         <span class="ruby-comment cmt"># send email to admin</span>
638:         
639:         <span class="ruby-comment cmt"># send email to customer</span>
640:         
641:       <span class="ruby-keyword kw">else</span>
642:         <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;Sorry, your order couldn't be placed. Please make sure you entered all information.&quot;</span>
643:         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:back</span>
644:       <span class="ruby-keyword kw">end</span>    
645:     <span class="ruby-keyword kw">end</span>
646:     
647:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000159" class="method-detail">
        <a name="M000159"></a>

        <div class="method-heading">
          <a href="#M000159" class="method-signature">
          <span class="method-name">product</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000159-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000159-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 259</span>
259:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">product</span>
260:     
261:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:label</span>] = <span class="ruby-value str">&quot;&quot;</span>
262:     
263:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:product_layout</span>] = <span class="ruby-value str">&quot;def&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:product_layout</span>].<span class="ruby-identifier">blank?</span>
264:     
265:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:product_layout</span>] = <span class="ruby-value str">&quot;classic&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:layout</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;classic&quot;</span>
266:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:product_layout</span>] = <span class="ruby-value str">&quot;def&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:layout</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;def&quot;</span>
267:     
268:     <span class="ruby-ivar">@product</span> = <span class="ruby-constant">Product</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
269:           
270:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:last_product_id_viewed</span>] = <span class="ruby-ivar">@product</span>.<span class="ruby-identifier">id</span>
271:           
272:     <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">getAccount</span>()
273:     
274:     <span class="ruby-ivar">@product</span>.<span class="ruby-identifier">update_attribute</span>(<span class="ruby-value str">&quot;views&quot;</span>, <span class="ruby-ivar">@product</span>.<span class="ruby-identifier">views</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>)
275:     
276:     <span class="ruby-ivar">@page_title</span> = <span class="ruby-value str">&quot;Product - &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@product</span>.<span class="ruby-identifier">title</span>
277: 
278:     <span class="ruby-ivar">@similar_products</span> = <span class="ruby-constant">Product</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:conditions=</span><span class="ruby-operator">&gt;</span>[<span class="ruby-value str">&quot;category_id = ? and id != ?&quot;</span>, <span class="ruby-ivar">@product</span>.<span class="ruby-identifier">category_id</span>, <span class="ruby-ivar">@product</span>.<span class="ruby-identifier">id</span>], <span class="ruby-identifier">:limit=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">8</span>)
279: 
280:     <span class="ruby-identifier">render</span>(<span class="ruby-identifier">:file</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{RAILS_ROOT}/app/views/templates/#{Shop.def_template_name}/frontend/#{action_name}.html.erb&quot;</span>, 
281:       <span class="ruby-identifier">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
282:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000167" class="method-detail">
        <a name="M000167"></a>

        <div class="method-heading">
          <a href="#M000167" class="method-signature">
          <span class="method-name">product_refunds_specifications</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000167-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000167-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 442</span>
442:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">product_refunds_specifications</span>
443:     <span class="ruby-comment cmt">#</span>
444:     <span class="ruby-ivar">@page_title</span> = <span class="ruby-value str">&quot;Product Refunds and Specifications&quot;</span>
445:     <span class="ruby-ivar">@page</span> = <span class="ruby-constant">Page</span>.<span class="ruby-identifier">find_by_title</span>(<span class="ruby-ivar">@page_title</span>)
446:     <span class="ruby-identifier">render</span>(<span class="ruby-identifier">:file</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{RAILS_ROOT}/app/views/templates/#{Shop.def_template_name}/frontend/#{action_name}.html.erb&quot;</span>, 
447:       <span class="ruby-identifier">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
448:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000163" class="method-detail">
        <a name="M000163"></a>

        <div class="method-heading">
          <a href="#M000163" class="method-signature">
          <span class="method-name">registration</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000163-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000163-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 368</span>
368:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">registration</span>
369:     <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">not</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:type</span>].<span class="ruby-identifier">blank?</span>
370:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:type</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;dealer&quot;</span>
371:         <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:account_type</span>] = <span class="ruby-value">0</span>
372:       <span class="ruby-keyword kw">else</span>
373:         <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:account_type</span>] = <span class="ruby-value">1</span>
374:       <span class="ruby-keyword kw">end</span>
375:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'new'</span>, <span class="ruby-identifier">:controller=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'accounts'</span>
376:           
377:     <span class="ruby-keyword kw">else</span>
378:       <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:account_type</span>] = <span class="ruby-keyword kw">nil</span>
379:       <span class="ruby-identifier">render</span>(<span class="ruby-identifier">:file</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{RAILS_ROOT}/app/views/templates/#{Shop.def_template_name}/frontend/#{action_name}.html.erb&quot;</span>, 
380:         <span class="ruby-identifier">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
381:     <span class="ruby-keyword kw">end</span>
382:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000157" class="method-detail">
        <a name="M000157"></a>

        <div class="method-heading">
          <a href="#M000157" class="method-signature">
          <span class="method-name">search</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
TODO: re-design <a href="GoController.html#M000157">search</a> action
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000157-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000157-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 167</span>
167:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">search</span>
168:     
169:     <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">getAccount</span>()
170:     
171:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:sort</span>] = <span class="ruby-value str">&quot;id DESC&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:sort</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span>
172:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:sort</span>] = <span class="ruby-value str">'price'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:sort</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;lprice&quot;</span>
173:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:sort</span>] = <span class="ruby-value str">'id DESC'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:sort</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;latest&quot;</span>
174:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:sort</span>] = <span class="ruby-value str">'price DESC'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:sort</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;hprice&quot;</span>
175:     <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:sort</span>] = <span class="ruby-value str">'title'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:sort</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;title&quot;</span>
176:     
177:     <span class="ruby-comment cmt"># request from search form</span>
178:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span>
179:       <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:darken</span>] = <span class="ruby-keyword kw">false</span>
180:       <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:label</span>] = <span class="ruby-value str">&quot;&quot;</span>
181:       
182:       <span class="ruby-ivar">@page_title</span> = <span class="ruby-value str">&quot;Search&quot;</span>
183:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:search</span>][<span class="ruby-identifier">:query</span>].<span class="ruby-identifier">blank?</span>
184:         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'index'</span>, <span class="ruby-identifier">:controller=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'go'</span>
185:       <span class="ruby-keyword kw">else</span>
186:         
187:         <span class="ruby-identifier">query</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:search</span>][<span class="ruby-identifier">:query</span>]
188: 
189: 
190:         <span class="ruby-comment cmt">#@product_pages, @products = paginate(:product, :conditions =&gt; [&quot;match(details,title) against  (?)&quot;, query], :order=&gt; session[:sort])</span>
191: 
192:         <span class="ruby-comment cmt">##########</span>
193:         <span class="ruby-identifier">q</span> = <span class="ruby-identifier">query</span>
194:         <span class="ruby-identifier">q</span> = <span class="ruby-identifier">query</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/\s/</span>, <span class="ruby-value str">' , '</span>)
195: 
196:         <span class="ruby-identifier">q</span> = <span class="ruby-value str">&quot;%&quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">q</span><span class="ruby-operator">+</span><span class="ruby-value str">&quot;%&quot;</span>
197: 
198:         <span class="ruby-ivar">@products</span> = <span class="ruby-constant">Product</span>.<span class="ruby-identifier">paginate</span>(<span class="ruby-identifier">:order=</span><span class="ruby-operator">&gt;</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:sort</span>], 
199:           <span class="ruby-identifier">:per_page</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">10</span>, 
200:           <span class="ruby-identifier">:page=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:page</span>],
201:           <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;title like ? OR details like ? OR labels like ?&quot;</span>, <span class="ruby-identifier">q</span>,<span class="ruby-identifier">q</span>,<span class="ruby-identifier">q</span>])
202:         <span class="ruby-comment cmt">##########</span>
203: 
204:         <span class="ruby-ivar">@header</span> = <span class="ruby-value str">&quot;Product(s) for your query: '&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">query</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;'&quot;</span>
205: 
206:         <span class="ruby-identifier">render</span>(<span class="ruby-identifier">:file</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{RAILS_ROOT}/app/views/templates/#{Shop.def_template_name}/frontend/#{action_name}.html.erb&quot;</span>, 
207:           <span class="ruby-identifier">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
208:       <span class="ruby-keyword kw">end</span>    
209:     <span class="ruby-keyword kw">end</span>
210:     
211:     
212:     <span class="ruby-comment cmt"># request from menu</span>
213:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">get?</span>
214:       
215:       <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:darken</span>] = <span class="ruby-keyword kw">true</span>
216:       
217:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:label</span>].<span class="ruby-identifier">blank?</span>
218:         <span class="ruby-ivar">@page_title</span> = <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:label</span>].<span class="ruby-identifier">to_s</span>
219:         <span class="ruby-identifier">query</span> = <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:label</span>].<span class="ruby-identifier">to_s</span> 
220:         <span class="ruby-comment cmt">#session[:label] = query</span>
221:       <span class="ruby-keyword kw">else</span>
222:         <span class="ruby-ivar">@page_title</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:label</span>].<span class="ruby-identifier">to_s</span>
223:         <span class="ruby-identifier">query</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:label</span>].<span class="ruby-identifier">to_s</span> 
224:         <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:label</span>] = <span class="ruby-identifier">query</span> 
225:       <span class="ruby-keyword kw">end</span>    
226:       
227:       <span class="ruby-identifier">q</span> = <span class="ruby-value str">&quot;%&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">query</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;%&quot;</span>
228:       <span class="ruby-identifier">q</span> = <span class="ruby-identifier">q</span>.<span class="ruby-identifier">downcase</span>
229:      
230:       <span class="ruby-ivar">@products</span> = <span class="ruby-constant">Product</span>.<span class="ruby-identifier">paginate</span>(<span class="ruby-identifier">:order=</span><span class="ruby-operator">&gt;</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:sort</span>], 
231:         <span class="ruby-identifier">:per_page</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">8</span>, 
232:         <span class="ruby-identifier">:page=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">params</span>[<span class="ruby-identifier">:page</span>],
233:         <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;labels like ?&quot;</span>, <span class="ruby-identifier">q</span>])
234:       
235:       <span class="ruby-ivar">@header</span> = <span class="ruby-value str">&quot;&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">query</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;&quot;</span>
236:       
237:       <span class="ruby-identifier">render</span>(<span class="ruby-identifier">:file</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{RAILS_ROOT}/app/views/templates/#{Shop.def_template_name}/frontend/#{action_name}.html.erb&quot;</span>, 
238:         <span class="ruby-identifier">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
239:     <span class="ruby-keyword kw">end</span>  
240:     
241:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000166" class="method-detail">
        <a name="M000166"></a>

        <div class="method-heading">
          <a href="#M000166" class="method-signature">
          <span class="method-name">terms_conditions</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000166-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000166-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 434</span>
434:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">terms_conditions</span>
435:     <span class="ruby-comment cmt">#</span>
436:     <span class="ruby-ivar">@page_title</span> = <span class="ruby-value str">&quot;Terms and Conditions&quot;</span>
437:     <span class="ruby-ivar">@page</span> = <span class="ruby-constant">Page</span>.<span class="ruby-identifier">find_by_title</span>(<span class="ruby-ivar">@page_title</span>)
438:     <span class="ruby-identifier">render</span>(<span class="ruby-identifier">:file</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{RAILS_ROOT}/app/views/templates/#{Shop.def_template_name}/frontend/#{action_name}.html.erb&quot;</span>, 
439:       <span class="ruby-identifier">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
440:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000153" class="method-detail">
        <a name="M000153"></a>

        <div class="method-heading">
          <a href="#M000153" class="method-signature">
          <span class="method-name">update_account_info</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000153-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000153-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 64</span>
 64:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update_account_info</span>
 65:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span>
 66:       <span class="ruby-identifier">contact_name</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:account</span>][<span class="ruby-identifier">:contact_name</span>]
 67:       <span class="ruby-identifier">b_addr</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:account</span>][<span class="ruby-identifier">:business_address</span>]
 68:       <span class="ruby-identifier">s_addr</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:account</span>][<span class="ruby-identifier">:shipping_address</span>]
 69:       <span class="ruby-identifier">email</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:account</span>][<span class="ruby-identifier">:email</span>]
 70:       
 71:       <span class="ruby-identifier">account</span> = <span class="ruby-identifier">getAccount</span>()
 72:       
 73:       <span class="ruby-identifier">err</span> = <span class="ruby-value str">&quot;Updated.&quot;</span>
 74:       
 75:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">account</span>.<span class="ruby-identifier">update_attribute</span>(<span class="ruby-value str">'contact_name'</span>, <span class="ruby-identifier">contact_name</span>)
 76:         
 77:       <span class="ruby-keyword kw">else</span>
 78:         <span class="ruby-identifier">err</span> = <span class="ruby-value str">&quot;Contact Name couldn't be updated.&quot;</span>
 79:       <span class="ruby-keyword kw">end</span>
 80:       
 81:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">account</span>.<span class="ruby-identifier">update_attribute</span>(<span class="ruby-value str">'business_address'</span>, <span class="ruby-identifier">b_addr</span>)
 82:         
 83:       <span class="ruby-keyword kw">else</span>  
 84:         <span class="ruby-identifier">err</span> = <span class="ruby-value str">&quot;Address couldn't be updated.&quot;</span>
 85:       <span class="ruby-keyword kw">end</span>
 86:       
 87:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">account</span>.<span class="ruby-identifier">update_attribute</span>(<span class="ruby-value str">'shipping_address'</span>, <span class="ruby-identifier">s_addr</span>)
 88:         
 89:       <span class="ruby-keyword kw">else</span>  
 90:         <span class="ruby-identifier">err</span> = <span class="ruby-value str">&quot;Shipping Address couldn't be updated.&quot;</span>
 91:       <span class="ruby-keyword kw">end</span>
 92:       
 93:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">email</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})$/i</span>
 94:         <span class="ruby-identifier">account</span>.<span class="ruby-identifier">update_attribute</span>(<span class="ruby-value str">'email'</span>, <span class="ruby-identifier">email</span>)
 95:       <span class="ruby-keyword kw">else</span>  
 96:         <span class="ruby-identifier">err</span> = <span class="ruby-value str">&quot;Email couldn't be updated.&quot;</span>
 97:       <span class="ruby-keyword kw">end</span>
 98:       
 99:       <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-identifier">err</span>
100:       
101:       <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'account'</span>)
102:       
103:     <span class="ruby-keyword kw">end</span>
104:     
105:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">get?</span>
106:       <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'account'</span>)
107:     <span class="ruby-keyword kw">end</span>
108:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000156" class="method-detail">
        <a name="M000156"></a>

        <div class="method-heading">
          <a href="#M000156" class="method-signature">
          <span class="method-name">view_cart</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000156-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000156-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 154</span>
154:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">view_cart</span>
155:     <span class="ruby-comment cmt">#</span>
156:     <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">getAccount</span>()
157:     <span class="ruby-ivar">@cart</span> = <span class="ruby-identifier">session</span>[<span class="ruby-identifier">:cart</span>]
158:     <span class="ruby-identifier">render</span>(<span class="ruby-identifier">:file</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{RAILS_ROOT}/app/views/templates/#{Shop.def_template_name}/frontend/#{action_name}.html.erb&quot;</span>, 
159:       <span class="ruby-identifier">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
160:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000169" class="method-detail">
        <a name="M000169"></a>

        <div class="method-heading">
          <a href="#M000169" class="method-signature">
          <span class="method-name">view_image</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Show the &#8216;large&#8217; version of image of a <a
href="GoController.html#M000159">product</a> This method should be moved to
a separate controller
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000169-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000169-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/go_controller.rb, line 478</span>
478:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">view_image</span>
479:     
480:     <span class="ruby-ivar">@image</span> = <span class="ruby-constant">Productimage</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
481:     <span class="ruby-comment cmt">#@page_title = &quot;Large Image - &quot; + @image.product.title</span>
482:     <span class="ruby-ivar">@page_title</span> = <span class="ruby-value str">&quot;View Large Image&quot;</span>
483:     <span class="ruby-identifier">render</span>(<span class="ruby-identifier">:file</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{RAILS_ROOT}/app/views/templates/#{Shop.def_template_name}/frontend/#{action_name}.html.erb&quot;</span>, 
484:       <span class="ruby-identifier">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>)
485:   <span class="ruby-keyword kw">rescue</span>
486:     <span class="ruby-identifier">render</span> <span class="ruby-identifier">:layout=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">:inline=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;ERROR CODE: 8807.&quot;</span>
487:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>